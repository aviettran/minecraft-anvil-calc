!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,l=new Array(t);i<t;i++)l[i]=e[i];return l}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,i){if(t){if("string"===typeof t)return e(t,i);var l=Object.prototype.toString.call(t).slice(8,-1);return"Object"===l&&t.constructor&&(l=t.constructor.name),"Map"===l||"Set"===l?Array.from(t):"Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?e(t,i):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function l(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var n=l.call(e,t||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function n(e,t,i){return(t=l(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,l)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var a=JSON.parse('[{"name":"protection","display_name":"Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":1,"book_multiplier":1,"group":"protection"},{"name":"fire_protection","display_name":"Fire Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":2,"book_multiplier":1,"group":"protection"},{"name":"feather_falling","display_name":"Feather Falling","max_level":4,"applies_to":["boots"],"item_multiplier":2,"book_multiplier":1},{"name":"blast_protection","display_name":"Blast Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":4,"book_multiplier":2,"group":"protection"},{"name":"projectile_protection","display_name":"Projectile Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":2,"book_multiplier":1,"group":"protection"},{"name":"thorns","display_name":"Thorns","max_level":3,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":8,"book_multiplier":4},{"name":"respiration","display_name":"Respiration","max_level":3,"applies_to":["helmet","turtle_helmet"],"item_multiplier":4,"book_multiplier":2},{"name":"depth_strider","display_name":"Depth Strider","max_level":3,"applies_to":["boots"],"item_multiplier":4,"book_multiplier":2,"group":"mobility"},{"name":"aqua_affinity","display_name":"Aqua Affinity","max_level":1,"applies_to":["helmet","turtle_helmet"],"item_multiplier":4,"book_multiplier":2},{"name":"sharpness","display_name":"Sharpness","max_level":5,"applies_to":["sword","axe"],"item_multiplier":1,"book_multiplier":1,"group":"attack"},{"name":"smite","display_name":"Smite","max_level":5,"applies_to":["sword","axe"],"item_multiplier":2,"book_multiplier":1,"group":"attack"},{"name":"bane_of_arthropods","display_name":"Bane of Arthropods","max_level":5,"applies_to":["sword","axe"],"item_multiplier":2,"book_multiplier":1,"group":"attack"},{"name":"knockback","display_name":"Knockback","max_level":2,"applies_to":["sword"],"item_multiplier":2,"book_multiplier":1},{"name":"fire_aspect","display_name":"Fire Aspect","max_level":2,"applies_to":["sword"],"item_multiplier":4,"book_multiplier":2},{"name":"looting","display_name":"Looting","max_level":3,"applies_to":["sword"],"item_multiplier":4,"book_multiplier":2},{"name":"efficiency","display_name":"Efficiency","max_level":5,"applies_to":["pickaxe","shovel","axe","shears","hoe"],"item_multiplier":1,"book_multiplier":1},{"name":"silk_touch","display_name":"Silk Touch","max_level":1,"applies_to":["pickaxe","shovel","axe","hoe","shears"],"item_multiplier":8,"book_multiplier":4,"group":"tool_type","java_overrides":{"applies_to":["pickaxe","shovel","axe","hoe"]}},{"name":"unbreaking","display_name":"Unbreaking","max_level":3,"applies_to":["pickaxe","shovel","axe","fishing_rod","helmet","chestplate","leggings","boots","sword","bow","hoe","shears","flint_and_steel","carrot_on_a_stick","warped_fungus_on_a_stick","shield","elytra","turtle_helmet","trident","crossbow","brush"],"item_multiplier":2,"book_multiplier":1},{"name":"fortune","display_name":"Fortune","max_level":3,"applies_to":["pickaxe","shovel","axe","hoe"],"item_multiplier":4,"book_multiplier":2,"group":"tool_type"},{"name":"power","display_name":"Power","max_level":5,"applies_to":["bow"],"item_multiplier":1,"book_multiplier":1},{"name":"punch","display_name":"Punch","max_level":2,"applies_to":["bow"],"item_multiplier":4,"book_multiplier":2},{"name":"flame","display_name":"Flame","max_level":1,"applies_to":["bow"],"item_multiplier":4,"book_multiplier":2},{"name":"infinity","display_name":"Infinity","max_level":1,"applies_to":["bow"],"item_multiplier":8,"book_multiplier":4,"group":"bow_type"},{"name":"luck_of_the_sea","display_name":"Luck of the Sea","max_level":3,"applies_to":["fishing_rod"],"item_multiplier":4,"book_multiplier":2},{"name":"lure","display_name":"Lure","max_level":3,"applies_to":["fishing_rod"],"item_multiplier":4,"book_multiplier":2},{"name":"frost_walker","display_name":"Frost Walker","max_level":2,"applies_to":["boots"],"item_multiplier":4,"book_multiplier":2,"enchanting_table":false,"group":"mobility"},{"name":"mending","display_name":"Mending","max_level":1,"applies_to":["pickaxe","shovel","axe","fishing_rod","helmet","chestplate","leggings","boots","sword","bow","hoe","shears","flint_and_steel","carrot_on_a_stick","warped_fungus_on_a_stick","shield","elytra","turtle_helmet","trident","crossbow"],"item_multiplier":4,"book_multiplier":2,"group":"bow_type","enchanting_table":false},{"name":"binding_curse","display_name":"Curse of Binding","max_level":1,"applies_to":["helmet","chestplate","leggings","boots","elytra","carved_pumpkin","head","turtle_helmet","brush"],"item_multiplier":8,"book_multiplier":4,"enchanting_table":false,"is_curse":true},{"name":"vanishing_curse","display_name":"Curse of Vanishing","max_level":1,"applies_to":["pickaxe","shovel","axe","fishing_rod","helmet","chestplate","leggings","boots","sword","bow","hoe","shears","flint_and_steel","carrot_on_a_stick","warped_fungus_on_a_stick","shield","elytra","carved_pumpkin","head","turtle_helmet","trident","crossbow","brush"],"item_multiplier":8,"book_multiplier":4,"enchanting_table":false,"is_curse":true},{"name":"impaling","display_name":"Impaling","max_level":5,"applies_to":["trident"],"item_multiplier":2,"book_multiplier":1,"java_overrides":{"item_multiplier":4,"book_multiplier":2}},{"name":"riptide","display_name":"Riptide","max_level":3,"applies_to":["trident"],"item_multiplier":4,"book_multiplier":2,"group":"trident_type"},{"name":"loyalty","display_name":"Loyalty","max_level":3,"applies_to":["trident"],"item_multiplier":1,"book_multiplier":1,"group":"trident_type","group_exception":"returnable"},{"name":"channeling","display_name":"Channeling","max_level":1,"applies_to":["trident"],"item_multiplier":8,"book_multiplier":4,"group":"trident_type","group_exception":"returnable"},{"name":"multishot","display_name":"Multishot","max_level":1,"applies_to":["crossbow"],"item_multiplier":4,"book_multiplier":2,"group":"crossbow_type"},{"name":"piercing","display_name":"Piercing","max_level":4,"applies_to":["crossbow"],"item_multiplier":1,"book_multiplier":1,"group":"crossbow_type"},{"name":"quick_charge","display_name":"Quick Charge","max_level":3,"applies_to":["crossbow"],"item_multiplier":2,"book_multiplier":1},{"name":"soul_speed","display_name":"Soul Speed","max_level":3,"applies_to":["boots"],"item_multiplier":8,"book_multiplier":4,"enchanting_table":false},{"name":"sweeping_edge","display_name":"Sweeping Edge","max_level":3,"applies_to":["sword"],"item_multiplier":4,"book_multiplier":2,"java_only":true},{"name":"swift_sneak","display_name":"Swift Sneak","max_level":3,"applies_to":["leggings"],"item_multiplier":8,"book_multiplier":4}]'),p=function(e){var t=r({},e);return t.enchantments=t.enchantments.map((function(e){return r(r({},e),{},{specification:a.find((function(t){return t.name===e.name}))})})),t},m=function(e,i,l,n){return l.reduce((function(i,l){if(!l.specification)throw"Error: no specification for Enchantment.";var o=function(e,t,i){var l,n,o,r;return i?"book"===e.name?null!==(l=null===(n=t.java_overrides)||void 0===n?void 0:n.book_multiplier)&&void 0!==l?l:t.book_multiplier:null!==(o=null===(r=t.java_overrides)||void 0===r?void 0:r.item_multiplier)&&void 0!==o?o:t.item_multiplier:"book"===e.name?t.book_multiplier:t.item_multiplier}(e,l.specification,n.java_edition),a=i.resultingEnchantments.find((function(e){return e.name===l.name})),p=l.level;if(a){var m=r({},a),s=l.level-m.level;0===s&&m.specification&&m.specification.max_level>m.level&&(s+=1,p+=1),s>0&&(i.cost+=n.java_edition?0:s*o,m.level=p,i.resultingEnchantments=[].concat(t(i.resultingEnchantments.filter((function(e){return e.name!==m.name}))),[m])),i.cost+=n.java_edition?p*o:0}else i.resultingEnchantments=[].concat(t(i.resultingEnchantments),[l]),i.cost+=p*o;return i}),{cost:0,resultingEnchantments:t(i)})};var s=function e(i,l){i=i.map(p);var n=[];return i.forEach((function(o){var a=i.filter((function(e){return e!==o})),p=a.filter((function(e){return"book"===e.name||"book"!==o.name}));p.length>0&&("book"===o.name&&(p=[p.reduce((function(e,t){return m(t,o.enchantments,t.enchantments,l).cost<m(e,o.enchantments,e.enchantments,l).cost?t:e}),p[0])]),p.forEach((function(i){var p=function(e,t,i){var l=e.penalty||0,n=t.penalty||0,o=t.enchantments.filter((function(t){return t.specification&&function(e,t){return!e.enchantments.some((function(e){return e.specification&&e.name!==t.name&&e.specification.group&&t.group&&e.specification.group===t.group&&!(e.specification.group_exception&&t.group_exception&&e.specification.group_exception===t.group_exception)}))&&(t.applies_to.some((function(t){return t===e.name}))||"book"===e.name)}(e,t.specification)}));if(!function(e,t){return!e.filter((function(e){return!t.includes(e)})).some((function(e){return e.preserve}))}(t.enchantments,o))return{error:!0,status:"Preserved enchantments have been lost"};var a,p=m(t,e.enchantments,o,i),s=r(r({},e),{},{enchantments:p.resultingEnchantments}),_=p.cost+Math.pow(2,l)-1+Math.pow(2,n)-1+(i.java_edition?t.enchantments.length-o.length:0);return s.penalty=Math.max(l,n)+1,{resultingItem:s,cost:_,exp:(a=_,a<17?Math.pow(a,2)+6*a:a<31?2.5*Math.pow(a,2)-40.5*a+360:4.5*Math.pow(a,2)-162.5*a+2220),steps:[{targetItem:e,sacrificeItem:t,resultingItem:s,stepCost:_}]}}(o,i,l);if(!("error"in p)||!p.error){var s=a.filter((function(e){return e!==i}));if(s.length>0){var _=e([p.resultingItem].concat(t(s)),l);if(function(e){return"error"in e}(_))return;p.resultingItem=_.resultingItem,p.cost+=_.cost,p.exp+=_.exp,p.steps=[].concat(t(p.steps),t(_.steps))}n=[].concat(t(n),[p])}})))})),n.length>0?n.reduce((function(e,t){return t.exp<e.exp?t:e}),n[0]):{targetItem:i[0],steps:[],error:!0,status:"No items or items cannot be combined."}},_=self;_.addEventListener("message",(function(e){_.postMessage(s(e.data.items,e.data.settings))}))}();
//# sourceMappingURL=worker.f19e710b.worker.js.map