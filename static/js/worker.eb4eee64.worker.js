!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,i){if(t){if("string"===typeof t)return e(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,i):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function n(e,t,i){return(t=a(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var r=JSON.parse('[{"name":"protection","display_name":"Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":1,"book_multiplier":1,"group":"protection"},{"name":"fire_protection","display_name":"Fire Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":2,"book_multiplier":1,"group":"protection"},{"name":"feather_falling","display_name":"Feather Falling","max_level":4,"applies_to":["boots"],"item_multiplier":2,"book_multiplier":1},{"name":"blast_protection","display_name":"Blast Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":4,"book_multiplier":2,"group":"protection"},{"name":"projectile_protection","display_name":"Projectile Protection","max_level":4,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":2,"book_multiplier":1,"group":"protection"},{"name":"thorns","display_name":"Thorns","max_level":3,"applies_to":["helmet","chestplate","leggings","boots","turtle_helmet"],"item_multiplier":8,"book_multiplier":4},{"name":"respiration","display_name":"Respiration","max_level":3,"applies_to":["helmet","turtle_helmet"],"item_multiplier":4,"book_multiplier":2},{"name":"depth_strider","display_name":"Depth Strider","max_level":3,"applies_to":["boots"],"item_multiplier":4,"book_multiplier":2,"group":"mobility"},{"name":"aqua_affinity","display_name":"Aqua Affinity","max_level":1,"applies_to":["helmet","turtle_helmet"],"item_multiplier":4,"book_multiplier":2},{"name":"sharpness","display_name":"Sharpness","max_level":5,"applies_to":["sword","axe"],"item_multiplier":1,"book_multiplier":1,"group":"attack"},{"name":"smite","display_name":"Smite","max_level":5,"applies_to":["sword","axe","mace"],"item_multiplier":2,"book_multiplier":1,"group":"attack"},{"name":"bane_of_arthropods","display_name":"Bane of Arthropods","max_level":5,"applies_to":["sword","axe","mace"],"item_multiplier":2,"book_multiplier":1,"group":"attack"},{"name":"knockback","display_name":"Knockback","max_level":2,"applies_to":["sword"],"item_multiplier":2,"book_multiplier":1},{"name":"fire_aspect","display_name":"Fire Aspect","max_level":2,"applies_to":["sword","mace"],"item_multiplier":4,"book_multiplier":2},{"name":"looting","display_name":"Looting","max_level":3,"applies_to":["sword"],"item_multiplier":4,"book_multiplier":2},{"name":"efficiency","display_name":"Efficiency","max_level":5,"applies_to":["pickaxe","shovel","axe","shears","hoe"],"item_multiplier":1,"book_multiplier":1},{"name":"silk_touch","display_name":"Silk Touch","max_level":1,"applies_to":["pickaxe","shovel","axe","hoe","shears"],"item_multiplier":8,"book_multiplier":4,"group":"tool_type","java_overrides":{"applies_to":["pickaxe","shovel","axe","hoe"]}},{"name":"unbreaking","display_name":"Unbreaking","max_level":3,"applies_to":["pickaxe","shovel","axe","fishing_rod","helmet","chestplate","leggings","boots","sword","bow","hoe","shears","flint_and_steel","carrot_on_a_stick","warped_fungus_on_a_stick","shield","elytra","turtle_helmet","trident","crossbow","brush","mace"],"item_multiplier":2,"book_multiplier":1},{"name":"fortune","display_name":"Fortune","max_level":3,"applies_to":["pickaxe","shovel","axe","hoe"],"item_multiplier":4,"book_multiplier":2,"group":"tool_type"},{"name":"power","display_name":"Power","max_level":5,"applies_to":["bow"],"item_multiplier":1,"book_multiplier":1},{"name":"punch","display_name":"Punch","max_level":2,"applies_to":["bow"],"item_multiplier":4,"book_multiplier":2},{"name":"flame","display_name":"Flame","max_level":1,"applies_to":["bow"],"item_multiplier":4,"book_multiplier":2},{"name":"infinity","display_name":"Infinity","max_level":1,"applies_to":["bow"],"item_multiplier":8,"book_multiplier":4,"group":"bow_type"},{"name":"luck_of_the_sea","display_name":"Luck of the Sea","max_level":3,"applies_to":["fishing_rod"],"item_multiplier":4,"book_multiplier":2},{"name":"lure","display_name":"Lure","max_level":3,"applies_to":["fishing_rod"],"item_multiplier":4,"book_multiplier":2},{"name":"frost_walker","display_name":"Frost Walker","max_level":2,"applies_to":["boots"],"item_multiplier":4,"book_multiplier":2,"enchanting_table":false,"group":"mobility"},{"name":"mending","display_name":"Mending","max_level":1,"applies_to":["pickaxe","shovel","axe","fishing_rod","helmet","chestplate","leggings","boots","sword","bow","hoe","shears","flint_and_steel","carrot_on_a_stick","warped_fungus_on_a_stick","shield","elytra","turtle_helmet","trident","crossbow","brush","mace"],"item_multiplier":4,"book_multiplier":2,"group":"bow_type","enchanting_table":false},{"name":"binding_curse","display_name":"Curse of Binding","max_level":1,"applies_to":["helmet","chestplate","leggings","boots","elytra","carved_pumpkin","head","turtle_helmet"],"item_multiplier":8,"book_multiplier":4,"enchanting_table":false,"is_curse":true},{"name":"vanishing_curse","display_name":"Curse of Vanishing","max_level":1,"applies_to":["pickaxe","shovel","axe","fishing_rod","helmet","chestplate","leggings","boots","sword","bow","hoe","shears","flint_and_steel","carrot_on_a_stick","warped_fungus_on_a_stick","shield","elytra","carved_pumpkin","head","turtle_helmet","trident","crossbow","brush","compass","recovery_compass","mace"],"item_multiplier":8,"book_multiplier":4,"enchanting_table":false,"is_curse":true},{"name":"impaling","display_name":"Impaling","max_level":5,"applies_to":["trident"],"item_multiplier":2,"book_multiplier":1,"java_overrides":{"item_multiplier":4,"book_multiplier":2}},{"name":"riptide","display_name":"Riptide","max_level":3,"applies_to":["trident"],"item_multiplier":4,"book_multiplier":2,"group":"trident_type"},{"name":"loyalty","display_name":"Loyalty","max_level":3,"applies_to":["trident"],"item_multiplier":1,"book_multiplier":1,"group":"trident_type","group_exception":"returnable"},{"name":"channeling","display_name":"Channeling","max_level":1,"applies_to":["trident"],"item_multiplier":8,"book_multiplier":4,"group":"trident_type","group_exception":"returnable"},{"name":"multishot","display_name":"Multishot","max_level":1,"applies_to":["crossbow"],"item_multiplier":4,"book_multiplier":2,"group":"crossbow_type"},{"name":"piercing","display_name":"Piercing","max_level":4,"applies_to":["crossbow"],"item_multiplier":1,"book_multiplier":1,"group":"crossbow_type"},{"name":"quick_charge","display_name":"Quick Charge","max_level":3,"applies_to":["crossbow"],"item_multiplier":2,"book_multiplier":1},{"name":"soul_speed","display_name":"Soul Speed","max_level":3,"applies_to":["boots"],"item_multiplier":8,"book_multiplier":4,"enchanting_table":false},{"name":"sweeping_edge","display_name":"Sweeping Edge","max_level":3,"applies_to":["sword"],"item_multiplier":4,"book_multiplier":2,"java_only":true},{"name":"swift_sneak","display_name":"Swift Sneak","max_level":3,"applies_to":["leggings"],"item_multiplier":8,"book_multiplier":4},{"name":"wind_burst","display_name":"Wind Burst","max_level":3,"base_max_level":1,"applies_to":["mace"],"item_multiplier":4,"book_multiplier":2},{"name":"density","display_name":"Density","max_level":5,"applies_to":["mace"],"item_multiplier":2,"book_multiplier":1,"group":"attack"},{"name":"breach","display_name":"Breach","max_level":4,"applies_to":["mace"],"item_multiplier":4,"book_multiplier":2,"group":"attack"}]'),m=JSON.parse('[{"name":"pickaxe","display_name":"Pickaxe"},{"name":"shovel","display_name":"Shovel"},{"name":"axe","display_name":"Axe"},{"name":"fishing_rod","display_name":"Fishing Rod"},{"name":"helmet","display_name":"Helmet"},{"name":"chestplate","display_name":"Chestplate"},{"name":"leggings","display_name":"Leggings"},{"name":"boots","display_name":"Boots"},{"name":"sword","display_name":"Sword"},{"name":"bow","display_name":"Bow"},{"name":"hoe","display_name":"Hoe"},{"name":"shears","display_name":"Shears"},{"name":"flint_and_steel","display_name":"Flint and Steel"},{"name":"carrot_on_a_stick","display_name":"Carrot on a Stick"},{"name":"warped_fungus_on_a_stick","display_name":"Warped Fungus on a Stick"},{"name":"shield","display_name":"Shield"},{"name":"elytra","display_name":"Elytra"},{"name":"carved_pumpkin","display_name":"Carved Pumpkin"},{"name":"head","display_name":"Head"},{"name":"turtle_helmet","display_name":"Turtle Helmet"},{"name":"trident","display_name":"Trident"},{"name":"crossbow","display_name":"Crossbow"},{"name":"book","display_name":"Book"},{"name":"brush","display_name":"Brush"},{"name":"compass","display_name":"Compass","image":"compass.webp"},{"name":"recovery_compass","display_name":"Recovery Compass","image":"recovery_compass.webp"},{"name":"mace","display_name":"Mace"}]'),p=(m.reduce((function(e,t){return e.set(t.name,t),e}),new Map),function(e){var t=o({},e);return t.enchantments=t.enchantments.map((function(e){return o(o({},e),{},{specification:r.find((function(t){return t.name===e.name}))})})),t}),s=function(e,i,a,n){return a.reduce((function(i,a){if(!a.specification)throw"Error: no specification for Enchantment.";var l=function(e,t,i){var a,n,l,o;return i?"book"===e.name?null!==(a=null===(n=t.java_overrides)||void 0===n?void 0:n.book_multiplier)&&void 0!==a?a:t.book_multiplier:null!==(l=null===(o=t.java_overrides)||void 0===o?void 0:o.item_multiplier)&&void 0!==l?l:t.item_multiplier:"book"===e.name?t.book_multiplier:t.item_multiplier}(e,a.specification,n.java_edition),r=i.resultingEnchantments.find((function(e){return e.name===a.name})),m=a.level;if(r){var p=o({},r),s=a.level-p.level;0===s&&p.specification&&p.specification.max_level>p.level&&(s+=1,m+=1),s>0&&(i.cost+=n.java_edition?0:s*l,p.level=m,i.resultingEnchantments=[].concat(t(i.resultingEnchantments.filter((function(e){return e.name!==p.name}))),[p])),i.cost+=n.java_edition?m*l:0}else i.resultingEnchantments=[].concat(t(i.resultingEnchantments),[a]),i.cost+=m*l;return i}),{cost:0,resultingEnchantments:t(i)})};var _=function e(i,a){i=i.map(p);var n=[];return i.forEach((function(l){var r=i.filter((function(e){return e!==l})),m=r.filter((function(e){return"book"===e.name||"book"!==l.name}));m.length>0&&("book"===l.name&&(m=[m.reduce((function(e,t){return s(t,l.enchantments,t.enchantments,a).cost<s(e,l.enchantments,e.enchantments,a).cost?t:e}),m[0])]),m.forEach((function(i){var m=function(e,t,i){var a=e.penalty||0,n=t.penalty||0,l=t.enchantments.filter((function(t){return t.specification&&function(e,t,i){return!e.enchantments.some((function(e){return e.specification&&e.name!==t.name&&e.specification.group&&t.group&&e.specification.group===t.group&&!(e.specification.group_exception&&t.group_exception&&e.specification.group_exception===t.group_exception)&&!("protection"===e.specification.group&&i.allow_multiple_armor_enhancements)}))&&(t.applies_to.some((function(t){return t===e.name}))||"book"===e.name)}(e,t.specification,i)}));if(!function(e,t){return!e.filter((function(e){return!t.includes(e)})).some((function(e){return e.preserve}))}(t.enchantments,l))return{error:!0,status:"Preserved enchantments have been lost"};var r,m=s(t,e.enchantments,l,i),p=o(o({},e),{},{enchantments:m.resultingEnchantments}),_=m.cost+Math.pow(2,a)-1+Math.pow(2,n)-1+(i.java_edition?t.enchantments.length-l.length:0);return p.penalty=Math.max(a,n)+1,{resultingItem:p,cost:_,exp:(r=_,r<17?Math.pow(r,2)+6*r:r<31?2.5*Math.pow(r,2)-40.5*r+360:4.5*Math.pow(r,2)-162.5*r+2220),steps:[{targetItem:e,sacrificeItem:t,resultingItem:p,stepCost:_}]}}(l,i,a);if(!("error"in m)||!m.error){var p=r.filter((function(e){return e!==i}));if(p.length>0){var _=e([m.resultingItem].concat(t(p)),a);if(function(e){return"error"in e}(_))return;m.resultingItem=_.resultingItem,m.cost+=_.cost,m.exp+=_.exp,m.steps=[].concat(t(m.steps),t(_.steps))}n=[].concat(t(n),[m])}})))})),n.length>0?n.reduce((function(e,t){return t.exp<e.exp?t:e}),n[0]):{targetItem:i[0],steps:[],error:!0,status:"No items or items cannot be combined."}},u=self;u.addEventListener("message",(function(e){u.postMessage(_(e.data.items,e.data.settings))}))}();
//# sourceMappingURL=worker.eb4eee64.worker.js.map